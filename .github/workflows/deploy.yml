name: Local Deploy via Self-Hosted Runner

on:
  workflow_run:
    workflows: ["Testy aplikacji"]
    types:
      - completed
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: self-hosted

    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@v4

      - name: ðŸ”§ Build Docker image
        run: docker build -t chat-app .

      - name: ðŸ§¹ Stop & remove old container
        run: |
          docker stop chat-app || true
          docker rm chat-app || true

      - name: ðŸš€ Run new container
        run: docker run -d --name chat-app -p 3000:3000 chat-app
